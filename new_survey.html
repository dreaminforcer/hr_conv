async function sendToWebhook() {
  const sheetUrl = document.getElementById("sheetUrl").value.trim();
  const resultDiv = document.getElementById("result");

  if (!sheetUrl) {
    resultDiv.innerText = "‚ùó –í–≤–µ–¥–∏—Ç–µ —Å—Å—ã–ª–∫—É.";
    return;
  }

  // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–ø–∏–Ω–Ω–µ—Ä
  resultDiv.innerHTML = '<div class="spinner"></div>';

  const encodedUrl = encodeURIComponent(sheetUrl);
  const webhookUrl = `https://hook.eu2.make.com/8chb12cy7p4sickibvpcp4lktlwmmxvw?survey_url=${encodedUrl}`;

  try {
    // üïê –ò—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ ‚Äî —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å —Å–ø–∏–Ω–Ω–µ—Ä
    await new Promise(resolve => setTimeout(resolve, 2000));

    const response = await fetch(webhookUrl, { method: "GET" });

    if (!response.ok) {
      throw new Error("–û—à–∏–±–∫–∞ –æ—Ç–≤–µ—Ç–∞ –æ—Ç –≤–µ–±—Ö—É–∫–∞");
    }

    const resultUrl = await response.text();

    resultDiv.innerHTML = `üîó <a href="${resultUrl}" target="_blank">${resultUrl}</a>`;
  } catch (error) {
    console.error(error);
    resultDiv.innerText = "üö´ –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –∑–∞–ø—Ä–æ—Å–∞.";
  }
}
